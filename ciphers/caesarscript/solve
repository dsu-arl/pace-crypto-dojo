#!/opt/pwn.college/python
import sys
import os
import random
import string
import pathlib

def print_flag():
    try:
        with open("/flag", "r") as f:
            print(f.read())
    except FileNotFoundError:
        print("Error: Flag file not found.")

def caesar_cipher_shift(word, shift):
    shifted_word = ""
    for char in word:
        if char.isalpha():  # Only shift alphabetic characters
            offset = ord('A') if char.isupper() else ord('a')
            shifted_char = chr((ord(char) - offset + shift) % 26 + offset)
            shifted_word += shifted_char
        else:
            shifted_word += char  # Non-alphabet characters remain unchanged
    return shifted_word

# Main function to execute the cipher game
def play_cipher_game():
    # get secret word from config file
    secret = (pathlib.Path(__file__).parent / ".config").read_text().strip().upper()
    
    shift = 17 # making shift constant

    # Encrypt the word and print the ciphertext
    encrypted_secret = caesar_cipher_shift(secret, shift)
    print(f"Some words are too long to decrypt by hand - try writing a script to help you!")
    print(f"\nDecrypt this word: {encrypted_secret}")
    print(f"It has been shifted by +{shift}. \nTo decrypt, you will need to undo the shifting.\n")

    # Get the user's guess and compare it to the original word
    guess = input("Enter your decrypted word: ").upper()
    if guess == secret:
        print("\nCongratulations, you decrypted it correctly!")
        print("Here's your flag!")
        print_flag()
    else:
        print("\nSorry, that was incorrect. Better luck next time!")

# Run the game
play_cipher_game()

